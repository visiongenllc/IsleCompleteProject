{% load static %}
{% load socialaccount %}
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JURASSIC WORLD COINS â€” Dinosaur Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    * {
      h5 {
        color: white;
      }
    }

    .text-muted {
      color: white !important;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(rgba(10, 20, 35, 0.8), rgba(10, 20, 35, 0.9)),
      url("{% static 'images/dino-bg.png' %}") center center / cover no-repeat;
      font-family: 'Inter', sans-serif;
      color: #e6f3fb;
      background-attachment: fixed;
    }

    .navbar {
      background: rgba(15, 25, 40, 0.6);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }

    .navbar-brand {
      color: #3aa3ff !important;
      font-weight: 700;
    }

    .hero {
      text-align: center;
      padding: 80px 20px 50px;
    }

    .card,
    .slot-card {
      border-radius: 16px;
      background: rgba(20, 30, 45, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
      transition: all 0.3s ease;
    }

    .card:hover,
    .slot-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 35px rgba(0, 0, 0, 0.7);
    }

    .btn-buy {
      background: linear-gradient(90deg, #3aa3ff, #1e7de8);
      border: none;
      color: #fff;
      border-radius: 10px;
      font-weight: 600;
      padding: 0.5rem 1.2rem;
    }

    .btn-buy:hover {
      transform: scale(1.05);
    }

    .slot-card {
      padding: 1.5rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
    }

    .progress {
      height: 8px;
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.1);
    }

    .progress-bar {
      background: linear-gradient(90deg, #3aa3ff, #1e7de8);
    }

    footer {
      text-align: center;
      padding: 30px 0;
      color: #8faecc;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      margin-top: 50px;
    }
  </style>
</head>

<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#">JURASSIC WORLD COINS Store</a>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto align-items-center">
          {% if player_profile.avatar_image %}
          <img src="{{ player_profile.avatar_image.url }}" width="40" class="rounded-circle me-2" alt="Avatar">
          {% elif player_profile.avatar_url %}
          <img src="{{ player_profile.avatar_url }}" width="40" class="rounded-circle me-2" alt="Avatar">
          {% elif player_profile.user.socialaccount_set.exists %}
          {% with acct=player_profile.user.socialaccount_set.first %}
          <img src="{{ acct.extra_data.avatarfull }}" width="40" class="rounded-circle me-2" alt="Avatar">
          {% endwith %}
          {% else %}
          <img src="{% static 'images/dino-avatar.png' %}" width="40" class="rounded-circle me-2" alt="Avatar">
          {% endif %}


          <li class="nav-item me-3 fw-semibold">{{ player_profile.user.username }}</li>
          <li class="nav-item me-3"><span class="badge bg-primary">Coins: {{ coin_balance }}</span></li>
          
          <a href="{% url 'store:player_dashboard' player_profile.steam_id %}" class="btn btn-outline-primary btn-sm">Player Dashboard</a>
          
          <li class="nav-item">
            <a class="btn btn-outline-light btn-sm" href="{% url 'store:logout' %}">Logout</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <section class="hero mt-5">
    <div class="container text-center">
      <h1>Dinosaur Management</h1>
      <p>Manage your dinosaur slots, view growth, and control your active dinos.</p>
    </div>
  </section>

  <!-- COINS SECTION -->
  <section class="container py-5">
    <h3 class="mb-4 text-center">ðŸ’° Buy Coins</h3>
    <div class="row justify-content-center g-4">
      {% for package in packages %}
      <div class="col-md-4">
        <div class="card p-4 text-center">
          <h5>{{ package.name }}</h5>
          <p class="small text-muted mb-1">${{ package.price_usd }}</p>
          <p class="small text-muted mb-3">Coins: {{ package.coins }}</p>
          <a href="{% url 'store:buy_coins' package.id %}" class="btn btn-buy w-100">Buy Now</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>

  </div>
  </section>

  <!-- DINO STORE -->
  <section class="container py-5">
    <h3 class="mb-4 text-center">ðŸ¦– Available Dinosaurs</h3>
    <div class="row g-4">
      {% for dino in dinos %}
      <div class="col-md-3">
        <div class="card h-100 p-3 text-center">
          {% if dino.image %}
          <img src="{{ dino.image.url }}" alt="{{ dino.name }}" class="img-fluid rounded mb-3">
          {% endif %}
          <h5>{{ dino.name }}</h5>
          <p class="small text-muted mb-3">{{ dino.coin_cost }} coins</p>
          <a href="{% url 'store:buy_dino' dino.id %}" class="btn btn-success btn-sm">Buy Dino</a>
        </div>
      </div>
      {% empty %}
      <p class="text-center">No dinosaurs available yet.</p>
      {% endfor %}
    </div>
  </section>

  <!-- DINO MANAGEMENT -->
  <section class="container py-5">
    <h3 class="mb-4 text-center">ðŸ§¬ Manage Your Dinosaurs</h3>
    <p class="text-center text-muted mb-5">View your slots, status, and details of active dinos.</p>

    <div class="row g-4">
      {% for slot in slots %}
      <div class="col-md-4">
        <div class="slot-card">
          <h5 class="text-center mb-3">Slot {{ forloop.counter }} â€” {{ slot.server_name }}</h5>

          {% if slot.active_dino %}
          <p><strong>Status:</strong> Occupied</p>
          <p><strong>Dino:</strong> {{ slot.active_dino.name }} ({{ slot.active_dino.gender|default:"Unknown" }})</p>
          <p><strong>Growth:</strong></p>
          <div class="progress mb-2">
            <div class="progress-bar" role="progressbar" style="width: {{ slot.growth|default:0 }}%"></div>
          </div>
          <p><small>Health: {{ slot.health|default:0 }} | Stamina: {{ slot.stamina|default:0 }}</small></p>
          <p><small>Hunger: {{ slot.hunger|default:0 }} | Thirst: {{ slot.thirst|default:0 }}</small></p>
          <div class="d-flex gap-2">
            <a href="{% url 'store:switch_dino' slot.id %}" class="btn btn-outline-info flex-fill">Switch</a>
            <a href="{% url 'store:release_dino' slot.id %}" class="btn btn-outline-danger flex-fill">Release</a>
          </div>
          {% else %}
          <p class="text-center text-muted">Available â€” No Dinosaur</p>
          <a href="{% url 'store:add_dino' slot.id %}" class="btn btn-sm btn-primary">Add Dino</a>
          {% endif %}
        </div>
      </div>
      {% empty %}
      <p class="text-center">No slot data available.</p>
      {% endfor %}
    </div>
  </section>

  <footer>
    <p>Â© 2025 JURASSIC WORLD COINS Game Store â€” Powered by VisionGEN</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>